function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Modal=/*#__PURE__*/function(){function Modal(el,options){var _this=this;_classCallCheck(this,Modal),this.el=el||"[data-rhenium-modal]",this.options=Modal.optionsMerger(options),this.activeEl="",["clickHandler","closeModalHandler","resizeHandler"].forEach(function(method){_this[method]=_this[method].bind(_this)}),this.init()}return _createClass(Modal,[{key:"attachEvents",value:function(){document.querySelector("string"==typeof this.options.prefix?".".concat(this.options.prefix,"-").concat(this.options.close.onClickOutsideElem):".".concat(this.options.close.onClickOutsideElem)).addEventListener("click",this.closeModalHandler),this.options.close.onKeyPress&&document.addEventListener("keydown",this.closeModalHandler),window.addEventListener("resize",this.resizeHandler);for(var modalElem,modalElems=document.querySelectorAll(this.el),i=0;i<modalElems.length;i+=1)modalElem=modalElems[i],modalElem.addEventListener("click",this.clickHandler)}},{key:"detachEvents",value:function(){window.removeEventListener("resize",this.resizeHandler);for(var modalElem,modalElems=document.querySelectorAll(this.el),i=0;i<modalElems.length;i+=1)modalElem=modalElems[i],modalElem.removeEventListener("click",this.clickHandler)}// eslint-disable-next-line
},{key:"clickHandler",value:function(e){e.preventDefault();var attr=e.target.closest(this.el).dataset.rheniumTarget;if(-1<[".","#"].indexOf(attr[0])){// console.log(attr);
// console.log(document.querySelectorAll(attr).length);
if(1<document.querySelectorAll(attr).length)throw new Error("[RHENIUM.MODAL ERROR] There is more than one target elements in DOM! \uD83D\uDE2D");return this.activeEl=attr,document.querySelector(attr).classList.add("rhenium-active"),!1}var contentProvider=attr.split(":")[0],contentId=attr.split(":")[1],contentUrl=this.generateLink(contentProvider,contentId);// console.log(contentUrl);
return!0}// eslint-disable-next-line
},{key:"resizeHandler",value:function(){console.log("resize handled")}},{key:"closeModalHandler",value:function(e){var closeElem="string"==typeof this.options.prefix?"".concat(this.options.prefix,"-").concat(this.options.close.elem):this.options.close.elem,closeOutsideElem="string"==typeof this.options.prefix?"".concat(this.options.prefix,"-").concat(this.options.close.onClickOutsideElem):this.options.close.onClickOutsideElem,contentElem="string"==typeof this.options.prefix?"".concat(this.options.prefix,"-").concat(this.options.close.contentElem):this.options.close.contentElem;e.keyCode&&27===e.keyCode&&document.querySelector(this.activeEl).classList.remove("rhenium-active"),(e.target&&e.target.classList.contains(closeOutsideElem)||e.target&&e.target.classList.contains(closeElem))&&(e.stopPropagation(),document.querySelector(this.activeEl).classList.remove("rhenium-active")),e.target&&e.target===("string"==typeof this.options.prefix?".".concat(this.options.prefix,"-").concat(this.options.close.contentElem):".".concat(this.options.close.contentElem))&&e.stopPropagation()}// eslint-disable-next-line
},{key:"generateLink",value:function(cProvider,cId){switch(cProvider){case"youtube":return"https://www.youtube.com/embed/".concat(cId);case"vimeo":return"https://player.vimeo.com/video/".concat(cId,"?title=0&byline=0&portrait=0");case"gmaps":return"https://www.google.com/maps/embed?pb=".concat(cId);case"url":return cId;default:throw new Error("[RHENIUM.MODAL ERROR] Unknown Content Provider! \uD83D\uDE2D");}}},{key:"destroy",value:function(){console.log("Destroying instance!"),this.detachEvents()}},{key:"init",value:function(){console.log("%c    Initializing Rhenium.Modal!    ","line-height: 2; background:#2B2E31; color: #FFD950; font-family: monospace;"),this.attachEvents()}}],[{key:"optionsMerger",value:function(opts){var instanceOptions={speed:300,type:"default",alert:!1,prefix:"rhenium",bem:{init:!1,modificator:!1},close:{elem:"modal-close",contentElem:"modal-content",onClickOutside:!0,onClickOutsideElem:"modal",onKeyPress:!0,onKeyPressCode:13},debug:!1,on:{init:function(){},open:function(){},close:function(){}}},userOptions=opts;return"null"===userOptions?Object.keys(userOptions).forEach(function(key){instanceOptions[key]=userOptions[key]}):instanceOptions}}]),Modal}();function closestPolyfill(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){var el=this;if(!document.documentElement.contains(el))return null;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode}while(null!==el&&1===el.nodeType);return null})}closestPolyfill();var Rhenium={Modal:Modal};window.Rhenium=Rhenium;export default Rhenium;export{Modal};
